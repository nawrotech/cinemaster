{% extends 'base.html.twig' %}

{% block title %}Available movies{% endblock %}

{% block body %}
    {{ include("partials/_search_input.html.twig", {
        action_route: "",
        query_value: app.request.get("q"),
        name: "q",
    }) }}


    <div class="grid-container">
      {% for movie in pager %}

        <div class="card" style="width: 18rem;">
            <div class="image-container">
                <img src="{{ asset(movie.posterPath, "uploads_url") }}" class="card-img-top" alt="{{ movie.title ~ "post-image" }}">
            </div>

                  <div class="card-body">
                      <h5 class="card-title">{{ movie.title }}</h5>
                      <p class="card-text text-truncate">{{ movie.overview }}</p>


                      <fieldset class="available-movies-screening-formats">
                          <legend class="msf-legend">Screening formats available in your cinema:</legend>
                                        
                                   {{ include("partials/movie/_add_movie_screening_formats.html.twig") }}

                                    <form action="{{path("app_movie_delete", {
                                        slug:  app.current_route_parameters.slug, 
                                        id: movie.id,
                                        q: app.request.get("q"),
                                        page: app.request.get("page")  
                                    
                                        })}}" 
                                        method="delete" 
                                        id="{{ "form" ~ loop.index }}"
                                        >
                                        <input type="hidden" name="token" value="{{ csrf_token('add-movie-formats-token') }}">
                                        <input type="hidden" name="formId" value="{{ "form" ~ loop.index }}">

                                        {% if isScheduledShowtimeForMovie[movie.id] == false %}
                                            <div class="row">
                                                <a href="{{ path("app_movie_create", {
                                                    id: movie.id,
                                                    slug:  app.current_route_parameters.slug, 
                                                }) }}" class="btn btn-primary col-6">Edit</a>
                                                <button class="btn btn-danger col-6">Delete Movie</button>

                                            </div>
                                        {% endif %}
                                    
                                    </form>


                            </div>
                     
                      </fieldset>
                  
                    </div>


               
      

                  
          
      {% endfor %}

      
  </div>
  {{ pagerfanta(pager, "twitter_bootstrap5") }}


{% endblock %}

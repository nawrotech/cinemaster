{% extends 'base.html.twig' %}

{% block title %}Add movies{% endblock %}

{% block body %}

    {{ include("partials/_search_input.html.twig", {
        action_route: "",
        query_value: app.request.get("q"),
        name: "q"
    }) }}

    <div class="grid-container">
        {% for movie in pager %}
            <form action="{{path("app_movie_add", {
                slug:  app.current_route_parameters.slug, 
                tmdbId: movie.id,
                q: app.request.get("q"),
                page: app.request.get("page")  
            
            })}}" 
            method="post" 
            class="card"
            id="{{ "form" ~ loop.index }}"
            style="width: 18rem;">
                    <input type="hidden" name="token" value="{{ csrf_token('add-movie') }}">
                    <input type="hidden" name="formId" value="{{ "form" ~ loop.index }}">
                    
                    <img src="{{ "https://image.tmdb.org/t/p/w300" ~ movie.poster_path }}" class="card-img-top" alt="{{ movie.title ~ "post-image" }}">
                   
                    <div class="card-body">
                        <h5 class="card-title">{{ movie.title }}</h5>
                        <p class="card-text text-truncate">{{ movie.overview }}</p>
                    </div>
                    
                    {% if movie.id in storedTmdbIds %}
                        <button name="remove-movie" value="1" class="btn btn-danger">Remove movie</button>
                    {% else %}
                        <button name="add-movie" value="1" class="btn btn-success">Add movie</button>
                    {% endif %}
            </form>
        {% endfor %}

    </div>
    {{ pagerfanta(pager, "twitter_bootstrap5") }}


{% endblock %}
